<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Module>
    <ModulePrefs author="RooX Solutions" author_email="support@roox.ru" height="50%" title="Messages" version="1.0-SNAPSHOT" width="50%">
        <Require feature="pubsub-2"/>
    </ModulePrefs>
    <Content type="html">
        <![CDATA[
            <script>
                gadgets.HubSettings = {};

                // Set default HubClient constructor params object
                gadgets.HubSettings.params = {
                HubClient: {
                    onSecurityAlert: function( alertSource, alertType ) {
                        alert( "Gadget stopped attempted security breach: " + alertType );
                        window.location.href = "about:blank"; // Forces container to see Frame Phish alert and probably close this gadget
                    }
                    <!--,-->
                    <!--scope: gadgetInstance-->
                }
                };

                // Set default onComplete function for HubClient.connect
                gadgets.HubSettings.onConnected = function( hub, suc, err ) { };
                gadgets.util.registerOnLoadHandler( function() {
                    try {
                        // Create the HubClient.
                        gadgets.Hub = new OpenAjax.hub.IframeHubClient(  gadgets.HubSettings.params );

                        // Connect to the ManagedHub
                        gadgets.Hub.connect( gadgets.HubSettings.onConnect );

                    } catch(e) {
                        // TODO: error handling should be consistent with other OS gadget initialization error handling
                        alert(e);
                    }
                    var message = {};
                    message["content"] = "hey,wassup?";
                    gadgets.Hub.publish("my_event_type", message);
                });
            </script>
        ]]>
    </Content>
</Module>